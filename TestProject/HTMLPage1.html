

<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<!-- Required meta tags -->
<meta charset="utf-8">
<!--sets the width of the page to follow the screen-width of the device (which will vary depending on the device), part sets the initial zoom level when the page is first loaded by the browser. -->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<head>

    <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="WWFlogo.png">

    <title>Materials Selection</title>

	<LINK rel=StyleSheet href="StyleSheet1.css" type="text/css"> 

</head>


<body>


<header class="header-search">

	<div class="header-limiter">

	<img class="logoImg" src="logo.png" />


        <nav>
			<a href="langselect.html">Change Language</a>
            <a href="regionselect.html">Change Region</a>
            <a href="HTMLPage1.html" class="selected">Materials Input</a>
            <a href="helppage.html">Help</a>
        </nav>


		<form id="searchthis" action="/search" style="display:inline;" method="get">
		<input id="namanyay-search-box" name="q" size="40" type="text" placeholder="Search for materials..."/>
		<input id="namanyay-search-btn" value="Go" type="submit"/>
		</form>



	</div>

</header>



<h1>Resource Optimization Input</h1>

<div class="InputOverall" style="min-height: 500px"> 

<div class="InputTabs" style="min-height: 500px">

<button class="tablink lefttab" onclick="openTab('AvailableMat', this)" id="defaultOpen">Available Materials</button>
<button class="tablink" onclick="openTab('Location', this)" id="LocTabLink">Climate</button>
<button class="tablink" onclick="openTab('Budget', this)" id="BudgetTabLink">Constraints</button>
<button class="tablink righttab" class="righttab" onclick="openTab('AdditionalInfo', this)" id="MiscTabLink">Additional Input</button> 

<div id="AvailableMat" class="tabcontent" style="min-height: 400px">
  <h3 style="margin-top: 30px;">Enter available materials here:</h3>
  <p><strong>This includes materials you own, materials you have access to, and materials you are able to purchase. Only fields marked with an <strong?* are required, but the more information you provide, the more accurate your results will be.</strong></p>
<table id="tbl">
    <tr>
        <td><strong>Material<span style="color: red;">*</span>: </strong></td>
        <td><input type="text" name="Name" ></td>
        <td>Amount (kg):</td>
        <td><input type="text" name="Amount" /></td>
        <td>Cost of Material ($/m<sup>3</sup>):</td>
        <td><input type="text" name="Cost" /></td>
        <td>Distance (km) from material:</td>
        <td><input type="text" name="Distance" /></td>
        <td class="addbuttonrow">
            <div class="smallcontainer addcontainer" onclick='addField()' value='Add Field'>
                <a class="button smallbutton addbutton"><span>+</span>Add</a>
            </div>
        </td>
    </tr>
</table>
</div>

<div id="Location" class="tabcontent" style="min-height: 400px">
  <h3 style="margin-top: 30px;">Enter additional information regarding your location here:</h3>
  
</div>

<div id="Budget" class="tabcontent" style="min-height: 400px">
  <h3 style="margin-top: 30px;">Enter your budget here:</h3>
</div>

<div id="AdditionalInfo" class="tabcontent" style="min-height: 400px">
  <h3 style="margin-top: 30px;">Enter the number of workers available here:</h3>
</div>

</div>

<div class="InputDisplay" style="min-height: 500px; min-width: 400px; float: right;">
	<h3>Previously Entered Info</h3>
	<table id="PrevInfoTable">
	  <tr>
		<td>Material</td>
		<td>Amount</td>
		<td>Cost</td>
		<td>Distance</td>
          </tr>
	</table> 

	<div class="smallcontainer clearcontainer clickclear" onclick='clearAll()' value='Clear All'>
	<a class="button smallbutton clearbutton"><span>✓</span>Clear</a>
	</div>
</div>
</div>

<div class="container">
<a href="HTMLPage2.html" class="button"><span>✓</span>Recommend Materials</a>
</div>

<div class="container" onclick='babyAlgo()'>
<a class="button" style="margin-bottom: 100px"><span>✓</span>Baby Algo</a>
</div>



<footer class="header-search footer-search">

	<div class="header-limiter footer-limiter">

<div class="container">
		<a href="" class="button rightfooterbutton"><span>></span>About Us</a>
</div>

<div class="container">
	<a href="" class="button leftfooterbutton"><span>></span>Download</a>
</div>
<div class="container" id="demo">
</div>
<div class="container" >
    Version 0.1
</div>

		<div class="select-style">
		<select>
		<option value="english">English</option>
		<option value="nepali">Nepali</option>
		</select>
		</div>

	</div>

</footer>


<script>//Get the element with id="defaultOpen" and click on it
document.getElementById("defaultOpen").click();

var materials = [];
var roofs = [];
var superstructures = [];
var foundations = [];
var userMaterials = [];
var avaliableRoofs = [];
var avaliableSuperstructures = [];
var avaliableFoundation = [];
var possibleStructs = [];

window.onload = function() {
        var d = new Date();
        document.getElementById("demo").innerHTML = "Current Date: " + d.toDateString();


}

function addField() {
        var table = document.getElementById("tbl");
        var tablelength = table.rows.length;
        var row = table.insertRow(tablelength);
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);
        var cell5 = row.insertCell(4);
        var cell6 = row.insertCell(5);
        var cell7 = row.insertCell(6);
        var cell8 = row.insertCell(7);
        var cell9 = row.insertCell(8);

        cell1.innerHTML = "<strong>Material<span style='color: red;'>*</span>: </strong>";
        cell2.innerHTML = "<input type='text'/>";
        cell3.innerHTML = "Amount (kg):";
        cell4.innerHTML = "<input type = 'text'/>";
        cell5.innerHTML = "Material Cost($/m<sup>3</sup>):";
        cell6.innerHTML = "<input type = 'text'/>";
        cell7.innerHTML = "Distance (km) from material:";
        cell8.innerHTML = "<input type = 'text'/>";
        cell9.innerHTML = "<div class='smallcontainer addcontainer' onclick = 'addField()' value = 'Add Field'> <a class='button smallbutton addbutton'><span>+</span>Add</a></div>"

        var rec_table = document.getElementById("PrevInfoTable");
        var rec_tablelength = rec_table.rows.length;
        var rec_row = rec_table.insertRow(rec_tablelength)
        for (i = 0; i < 4; i++) {
            var newCell = rec_row.insertCell(i);
            newCell.innerHTML = document.getElementById("tbl").rows[(tablelength - 1)].cells[(1 + (2 * i))].children[0].value;

        }

}


function clearAll() {
        var tableHeaderRowCount = 1;
        var table = document.getElementById("PrevInfoTable");
        var rowCount = table.rows.length;
        for (var i = tableHeaderRowCount; i < rowCount; i++) {
            table.deleteRow(tableHeaderRowCount);
        }

}

function openTab(tabName, elmnt) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }

        tablinks = document.getElementsByClassName("tablink");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].style.backgroundColor = "";
        }

        document.getElementById(tabName).style.display = "block";
        elmnt.style.backgroundColor = '#55A2B0';
        elmnt.style.color = 'black';


}


    function hardCodeMaterials() {
        var const1 = ['wood', 'CGI sheet'];
 
        roofs.push(Block('F1', 3546.3, ['wood', 'CGI sheet']));
        roofs.push(Block("F2", 2236.72, ["wood", "slate"]));
        roofs.push(Block("F3", 4327, ["bamboo", "CGI sheet"]));

        superstructures.push(Block("F8", 2570.9, ["brick", "concrete", "reinforcing bar", "mortar"]));
        superstructures.push(Block("F9", 1394.55, ["stone", "concrete", "reinforcing bar", "mortar"]));

        foundations.push(Block("F14", 3456.89, ["brick", "concrete", "reinforcing bar", "mortar"]));
        foundations.push(Block("F15", 1988.74, ["stone", "concrete", "reinforcing bar", "mortar"]));

        roofs.push(Block("butter", 1000, ["butter"]));
        superstructures.push(Block("butter", 100, ["butter"]));
        foundations.push(Block("butter", 20, ["butter"]));
        roofs.push(Block("gum", 2000, ["gum"]));
        superstructures.push(Block("gum", 200, ["gum"]));
        foundations.push(Block("gum", 10, ["gum"]));
        
    }

    function Block(nameIn, energyCostIn, constraintsIn) {
        var blck = new Object();

        blck.name = nameIn;
        blck.energyCost = energyCostIn;
        blck.constraints = constraintsIn;

        return blck;
    }


function buildUserMaterials(name) {


        var material = new Object();
        material.name = name;

        userMaterials.push(material);
}


function buildBlocks() {

        for (i = 0; i < roofs.length; i++) {
            if (constraintsMet(roofs[i].constraints) == true) {
                avaliableRoofs.push(roofs[i]);
            }
            
        }
        
        for (i = 0; i < superstructures.length; i++) {
            if (constraintsMet(superstructures[i].constraints) == true) {
                avaliableSuperstructures.push(superstructures[i]);
            }
        }
        

        for (i = 0; i < foundations.length; i++) {
            
            if (constraintsMet(foundations[i].constraints) == true) {
                avaliableFoundation.push(foundations[i]);
            }
            
        }

        
    }




function constraintsMet(constraints) {

        for (j = 0; j < constraints.length; j++) {
            if (materialEntered(constraints[j]) == false) {
                return false;
            }
        }
        
        return true;
}

    function grabMaterial() {
        var table = document.getElementById('PrevInfoTable');
        var length = table.rows.length;
        
        for (i = 1; i < length; i++) {
            var inputMat = table.rows[i].cells[0].children[0].value;
            document.write(inputMat);

            buildUserMaterials(inputMat);
        }
    }

    
function materialEntered(input) {

        for (i = 0; i < userMaterials; i++) {
            if (userMaterials[i].name == input) {
                return true;
            }
        }

        return false;
}

function buildStruct(roof, superstructure, foundations) {

        var struct = new Object();
        struct.roof = roof;
        struct.superstructure = superstructure;
        struct.foundation = foundations;
        possibleStructs.push(struct);
}

function energyCalc(index) {
        possibleStructs[index].energyCost = possibleStructs[index].roof.energyCost + possibleStructs[index].foundation.energyCost + possibleStructs[index].superstructure.energyCost;
    }
    
    function babyAlgo() {
        grabMaterial();
        hardCodeMaterials();

        buildBlocks();
        

        var curIndex = 0;
        var energyIndex = 0;
        
        for (i = 0; i < avaliableFoundation.length; i++) {
            for (j = 0; j < avaliableSuperstructures.length; j++) {
                for (k = 0; k < avaliableRoofs.length; k++) { 
                    buildStruct(avaliableRoofs[k], avaliableSuperstructures[j], avaliableFoundation[i]);
                    energyCalc(curIndex);
                    if (possibleStructs[curIndex].energyCost < possibleStructs[energyIndex].energyCost) {
                        energyIndex = curIndex;
                    }
                    curIndex++;
                }
            }
        }

        
        if (typeof (Storage) !== "undefined") {
            // Store
            localStorage.setItem("energy solution", possibleStructs[energyIndex]);
        } else {
            document.getElementById("result").innerHTML = "Sorry, your browser does not support Web Storage...";
        }

        //useful display when debugging algorithm
        
        document.write(" ");
        document.write(energyIndex);
        document.write(" Roof:");
        document.write(possibleStructs[energyIndex].roof.name);
        document.write(" Foundation:");
        document.write(possibleStructs[energyIndex].foundation.name);
        
        
    }
    
    

</script>



</body>
</html>